{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Personal%20Expense%20Analyzer/src/lib/db.js"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nlet pool;\r\n\r\nconst config = process.env.DATABASE_URL\r\n    ? {\r\n        connectionString: process.env.DATABASE_URL,\r\n        ssl: {\r\n            rejectUnauthorized: false, // For some cloud providers\r\n        },\r\n    }\r\n    : {\r\n        user: process.env.DB_USER || 'postgres',\r\n        host: process.env.DB_HOST || 'localhost',\r\n        database: process.env.DB_NAME || 'expense_tracker',\r\n        password: process.env.DB_PASSWORD || 'password',\r\n        port: process.env.DB_PORT || 5432,\r\n    };\r\n\r\nif (process.env.NODE_ENV === 'production') {\r\n  pool = new Pool(config);\r\n} else {\r\n  // In development mode, stick the pool in a global variable\r\n  // so we don't restart it every time the module reloads.\r\n  if (!global.pool) {\r\n    console.log('[DB] Initializing new pool (dev)');\r\n    global.pool = new Pool(config);\r\n  }\r\n  pool = global.pool;\r\n}\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,IAAI;AAEJ,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY,GACjC;IACE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK;QACD,oBAAoB;IACxB;AACJ,IACE;IACE,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;AACjC;AAEJ;;KAEO;IACL,2DAA2D;IAC3D,wDAAwD;IACxD,IAAI,CAAC,yDAAO,IAAI,EAAE;QAChB,QAAQ,GAAG,CAAC;QACZ,yDAAO,IAAI,GAAG,IAAI,qJAAI,CAAC;IACzB;IACA,OAAO,yDAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Personal%20Expense%20Analyzer/src/lib/authorize.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nexport function withAuth(handler) {\r\n    return async (req, res) => {\r\n        const token = req.headers.authorization;\r\n        if (!token) {\r\n            return res.status(401).json({ error: 'Access Denied: No Token Provided' });\r\n        }\r\n\r\n        try {\r\n            const tokenString = token.split(' ')[1];\r\n            if (!tokenString) throw new Error('Malformed Token');\r\n\r\n            const verified = jwt.verify(tokenString, process.env.JWT_SECRET || 'secret_key_123');\r\n            req.user = verified;\r\n\r\n            return handler(req, res);\r\n        } catch (err) {\r\n            return res.status(400).json({ error: 'Invalid Token' });\r\n        }\r\n    };\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS,SAAS,OAAO;IAC5B,OAAO,OAAO,KAAK;QACf,MAAM,QAAQ,IAAI,OAAO,CAAC,aAAa;QACvC,IAAI,CAAC,OAAO;YACR,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAmC;QAC5E;QAEA,IAAI;YACA,MAAM,cAAc,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;YACvC,IAAI,CAAC,aAAa,MAAM,IAAI,MAAM;YAElC,MAAM,WAAW,+KAAG,CAAC,MAAM,CAAC,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;YACnE,IAAI,IAAI,GAAG;YAEX,OAAO,QAAQ,KAAK;QACxB,EAAE,OAAO,KAAK;YACV,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAgB;QACzD;IACJ;AACJ"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Personal%20Expense%20Analyzer/src/pages/api/transactions/index.js"],"sourcesContent":["import pool from '../../../lib/db';\r\nimport { withAuth } from '../../../lib/authorize';\r\n\r\nasync function handler(req, res) {\r\n    const user_id = req.user.id;\r\n\r\n    if (req.method === 'GET') {\r\n        try {\r\n            const { type } = req.query;\r\n\r\n            if (!type || !['public', 'private'].includes(type)) {\r\n                return res.status(400).json({ error: 'Invalid or missing type parameter' });\r\n            }\r\n\r\n            const query = 'SELECT * FROM transactions WHERE account_type = $1 AND user_id = $2 ORDER BY txn_date DESC';\r\n            const params = [type, user_id];\r\n\r\n            const result = await pool.query(query, params);\r\n            res.json(result.rows);\r\n        } catch (err) {\r\n            console.error(err.message);\r\n            res.status(500).json({ error: 'Server Error' });\r\n        }\r\n    } else if (req.method === 'POST') {\r\n        try {\r\n            const { amount, category, description, txn_date, account_type } = req.body;\r\n\r\n            if (!amount || !category || !txn_date || !account_type) {\r\n                return res.status(400).json({ error: 'Missing required fields' });\r\n            }\r\n            if (!['public', 'private'].includes(account_type)) {\r\n                return res.status(400).json({ error: 'Invalid account_type' });\r\n            }\r\n\r\n            const newTxn = await pool.query(\r\n                'INSERT INTO transactions (user_id, amount, category, description, txn_date, account_type) VALUES ($1, $2, $3, $4, $5, $6) RETURNING *',\r\n                [user_id, amount, category, description, txn_date, account_type]\r\n            );\r\n\r\n            res.status(201).json(newTxn.rows[0]);\r\n        } catch (err) {\r\n            console.error(err.message);\r\n            res.status(500).json({ error: 'Server Error' });\r\n        }\r\n    } else {\r\n        res.status(405).json({ message: 'Method not allowed' });\r\n    }\r\n}\r\n\r\nexport default withAuth(handler);\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAEA,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC3B,MAAM,UAAU,IAAI,IAAI,CAAC,EAAE;IAE3B,IAAI,IAAI,MAAM,KAAK,OAAO;QACtB,IAAI;YACA,MAAM,EAAE,IAAI,EAAE,GAAG,IAAI,KAAK;YAE1B,IAAI,CAAC,QAAQ,CAAC;gBAAC;gBAAU;aAAU,CAAC,QAAQ,CAAC,OAAO;gBAChD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO;gBAAoC;YAC7E;YAEA,MAAM,QAAQ;YACd,MAAM,SAAS;gBAAC;gBAAM;aAAQ;YAE9B,MAAM,SAAS,MAAM,oHAAI,CAAC,KAAK,CAAC,OAAO;YACvC,IAAI,IAAI,CAAC,OAAO,IAAI;QACxB,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC,IAAI,OAAO;YACzB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAe;QACjD;IACJ,OAAO,IAAI,IAAI,MAAM,KAAK,QAAQ;QAC9B,IAAI;YACA,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,QAAQ,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI;YAE1E,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,YAAY,CAAC,cAAc;gBACpD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO;gBAA0B;YACnE;YACA,IAAI,CAAC;gBAAC;gBAAU;aAAU,CAAC,QAAQ,CAAC,eAAe;gBAC/C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO;gBAAuB;YAChE;YAEA,MAAM,SAAS,MAAM,oHAAI,CAAC,KAAK,CAC3B,yIACA;gBAAC;gBAAS;gBAAQ;gBAAU;gBAAa;gBAAU;aAAa;YAGpE,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE;QACvC,EAAE,OAAO,KAAK;YACV,QAAQ,KAAK,CAAC,IAAI,OAAO;YACzB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAe;QACjD;IACJ,OAAO;QACH,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAqB;IACzD;AACJ;uCAEe,IAAA,4HAAQ,EAAC"}}]
}