{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Personal%20Expense%20Analyzer/src/lib/db.js"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nlet pool;\r\n\r\nconst config = process.env.DATABASE_URL\r\n    ? {\r\n        connectionString: process.env.DATABASE_URL,\r\n        ssl: {\r\n            rejectUnauthorized: false, // For some cloud providers\r\n        },\r\n    }\r\n    : {\r\n        user: process.env.DB_USER || 'postgres',\r\n        host: process.env.DB_HOST || 'localhost',\r\n        database: process.env.DB_NAME || 'expense_tracker',\r\n        password: process.env.DB_PASSWORD || 'password',\r\n        port: process.env.DB_PORT || 5432,\r\n    };\r\n\r\nif (process.env.NODE_ENV === 'production') {\r\n  pool = new Pool(config);\r\n} else {\r\n  // In development mode, stick the pool in a global variable\r\n  // so we don't restart it every time the module reloads.\r\n  if (!global.pool) {\r\n    console.log('[DB] Initializing new pool (dev)');\r\n    global.pool = new Pool(config);\r\n  }\r\n  pool = global.pool;\r\n}\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,IAAI;AAEJ,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY,GACjC;IACE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK;QACD,oBAAoB;IACxB;AACJ,IACE;IACE,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;IAC7B,UAAU,QAAQ,GAAG,CAAC,OAAO,IAAI;IACjC,UAAU,QAAQ,GAAG,CAAC,WAAW,IAAI;IACrC,MAAM,QAAQ,GAAG,CAAC,OAAO,IAAI;AACjC;AAEJ;;KAEO;IACL,2DAA2D;IAC3D,wDAAwD;IACxD,IAAI,CAAC,yDAAO,IAAI,EAAE;QAChB,QAAQ,GAAG,CAAC;QACZ,yDAAO,IAAI,GAAG,IAAI,qJAAI,CAAC;IACzB;IACA,OAAO,yDAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/Personal%20Expense%20Analyzer/src/pages/api/auth/login.js"],"sourcesContent":["import pool from '../../../lib/db';\r\nimport bcrypt from 'bcryptjs';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nexport default async function handler(req, res) {\r\n    if (req.method !== 'POST') {\r\n        return res.status(405).json({ message: 'Method not allowed' });\r\n    }\r\n\r\n    try {\r\n        const { email, password } = req.body;\r\n\r\n        const user = await pool.query('SELECT * FROM users WHERE email = $1', [email]);\r\n        if (user.rows.length === 0) {\r\n            return res.status(400).json({ error: 'Invalid Email or Password' });\r\n        }\r\n\r\n        const validPass = await bcrypt.compare(password, user.rows[0].password_hash);\r\n        if (!validPass) {\r\n            return res.status(400).json({ error: 'Invalid Email or Password' });\r\n        }\r\n\r\n        const token = jwt.sign(\r\n            { id: user.rows[0].id, email: user.rows[0].email },\r\n            process.env.JWT_SECRET || 'secret_key_123',\r\n            { expiresIn: '1h' }\r\n        );\r\n\r\n        res.json({ token, user: { id: user.rows[0].id, username: user.rows[0].username, email: user.rows[0].email } });\r\n\r\n    } catch (err) {\r\n        console.error(err.message);\r\n        res.status(500).json({ error: 'Server Error' });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC1C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAqB;IAChE;IAEA,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;QAEpC,MAAM,OAAO,MAAM,oHAAI,CAAC,KAAK,CAAC,wCAAwC;YAAC;SAAM;QAC7E,IAAI,KAAK,IAAI,CAAC,MAAM,KAAK,GAAG;YACxB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA4B;QACrE;QAEA,MAAM,YAAY,MAAM,0KAAM,CAAC,OAAO,CAAC,UAAU,KAAK,IAAI,CAAC,EAAE,CAAC,aAAa;QAC3E,IAAI,CAAC,WAAW;YACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA4B;QACrE;QAEA,MAAM,QAAQ,+KAAG,CAAC,IAAI,CAClB;YAAE,IAAI,KAAK,IAAI,CAAC,EAAE,CAAC,EAAE;YAAE,OAAO,KAAK,IAAI,CAAC,EAAE,CAAC,KAAK;QAAC,GACjD,QAAQ,GAAG,CAAC,UAAU,IAAI,kBAC1B;YAAE,WAAW;QAAK;QAGtB,IAAI,IAAI,CAAC;YAAE;YAAO,MAAM;gBAAE,IAAI,KAAK,IAAI,CAAC,EAAE,CAAC,EAAE;gBAAE,UAAU,KAAK,IAAI,CAAC,EAAE,CAAC,QAAQ;gBAAE,OAAO,KAAK,IAAI,CAAC,EAAE,CAAC,KAAK;YAAC;QAAE;IAEhH,EAAE,OAAO,KAAK;QACV,QAAQ,KAAK,CAAC,IAAI,OAAO;QACzB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAe;IACjD;AACJ"}}]
}